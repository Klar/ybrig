"""Ybrig Open time date days"""

from influxdb import InfluxDBClient
import datetime

"""
curl -i -XPOST "http://10.0.1.2:8086/query?pretty=true" --data-urlencode "q=DROP DATABASE ybrig"
curl -i -XPOST "http://10.0.1.2:8086/query?pretty=true" --data-urlencode "q=CREATE DATABASE ybrig"
curl -i -XPOST "http://10.0.1.2:8086/query?pretty=true" --data-urlencode "q=CREATE USER ybrig WITH PASSWORD 'password'"
curl -i -XPOST "http://10.0.1.2:8086/query?pretty=true" --data-urlencode "q=GRANT ALL ON ybrig TO ybrig"
"""

# influxdb connection info
influx_ip = "127.0.0.1"
influx_port = 8086
influx_db = "ybrig"
influx_user = "ybrig"
influx_pw = "password"

# connection to influxdb
client = InfluxDBClient(influx_ip, influx_port, influx_user, influx_pw, influx_db)

def write_data(year, start_or_end_day, count_days):
    json_body = [
          {
            "measurement": influx_db,
            "time": start_or_end_day,
            "tags": {
              "Year": year,
              "Days": count_days,
            },
            "fields": {
              "days": count_days
            }
          }
      ]

    client.write_points(json_body)

ybrig_dict = {"1968/1969": ["24.12.1968", "07.04.1969", 105],
              "1969/1970": ["25.12.1969", "18.05.1970", 145],
              "1970/1971": ["24.12.1970", "21.04.1971", 119],
              "1971/1972": ["19.11.1971", "10.04.1972", 144],
              "1972/1973": ["25.11.1972", "06.05.1973", 163],
              "1973/1974": ["30.11.1973", "22.04.1974", 145],
              "1974/1975": ["05.10.1974", "04.05.1975", 202],
              "1975/1976": ["22.11.1975", "02.05.1976", 163],
              "1976/1977": ["27.11.1976", "08.05.1977", 163],
              "1977/1978": ["19.11.1977", "07.05.1978", 170],
              "1978/1979": ["02.12.1978", "13.05.1979", 158],
              "1979/1980": ["17.11.1979", "11.05.1980", 176],
              "1980/1981": ["04.12.1980", "20.04.1981", 138],
              "1981/1982": ["05.12.1981", "09.05.1982", 156],
              "1982/1983": ["21.12.1982", "01.05.1983", 132],
              "1983/1984": ["03.12.1983", "06.05.1984", 156],
              "1984/1985": ["22.12.1984", "28.04.1985", 128],
              "1985/1986": ["26.12.1985", "28.04.1986", 124],
              "1986/1987": ["20.12.1986", "01.05.1987", 133],
              "1987/1988": ["26.12.1987", "24.04.1988", 121],
              "1988/1989": ["10.12.1988", "09.04.1989", 121],
              "1989/1990": ["09.12.1989", "16.04.1990", 118],
              "1990/1991": ["10.11.1990", "15.04.1991", 145],
              "1991/1992": ["23.11.1991", "03.05.1992", 163],
              "1992/1993": ["05.12.1992", "25.04.1993", 131],
              "1993/1994": ["20.11.1993", "24.04.1994", 156],
              "1994/1995": ["24.12.1994", "25.04.1995", 123],
              "1995/1996": ["25.11.1995", "26.04.1996", 144],
              "1996/1997": ["30.11.1996", "13.04.1997", 135],
              "1997/1998": ["06.12.1997", "26.04.1998", 138],
              "1998/1999": ["21.11.1998", "02.05.1999", 163],
              "1999/2000": ["20.11.1999", "01.05.2000", 164],
              "2000/2001": ["16.12.2000", "01.05.2001", 137],
              "2001/2002": ["01.12.2001", "28.04.2002", 149],
              "2002/2003": ["07.12.2002", "27.04.2003", 135],
              "2003/2004": ["20.12.2003", "02.05.2004", 135],
              "2004/2005": ["27.11.2004", "24.04.2005", 149],
              "2005/2006": ["07.12.2005", "23.04.2006", 138],
              "2006/2007": ["13.12.2006", "16.04.2007", 125],
              "2007/2008": ["17.11.2007", "20.04.2008", 156],
              "2008/2009": ["26.12.2008", "19.04.2009", 145],
              "2009/2010": ["05.12.2009", "18.04.2010", 135],
              "2010/2011": ["01.12.2010", "10.04.2011", 131],
              "2011/2012": ["17.12.2011", "15.04.2012", 121],
              "2012/2013": ["08.12.2012", "14.04.2013", 128],
              "2013/2014": ["30.11.2013", "21.04.2014", 141],
              "2014/2015": ["24.12.2014", "12.04.2015", 109],
              "2015/2016": ["28.11.2015", "10.04.2016", 134],
              "2016/2017": ["24.12.2016", "09.04.2017", 106],
              "2017/2018": ["02.12.2017", "15.04.2018", 135],
              "2018/2019": ["15.12.2018", "22.04.2019", 129],
              }

for data in ybrig_dict:
    year = data
    start_day = ybrig_dict[data][0]
    end_day = ybrig_dict[data][1]
    count_days = int(ybrig_dict[data][2])

    format_str = '%d.%m.%Y'

    start_or_end_day = datetime.datetime.strptime(start_day, format_str)
    write_data(year, start_or_end_day, count_days)

    start_or_end_day = datetime.datetime.strptime(end_day, format_str)
    write_data(year, start_or_end_day, count_days)
